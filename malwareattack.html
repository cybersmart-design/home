<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CyberSmart | Virtual OS v23</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@400;900&display=swap" rel="stylesheet" />
    <style>
        :root {
            --bg: #0d1117; --accent: #03fc84; --cyan: #09eef5; --win-bg: #161b22;
            --border: #30363d; --taskbar: rgba(1, 4, 9, 0.95); --red: #ff3e3e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; }
        body { 
            background: #010409 url('https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&w=1920&q=80') center/cover;
            color: #fff; font-family: 'Outfit', sans-serif; height: 100vh; overflow: hidden; 
        }

        /* --- POWER OVERLAY --- */
        #power-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 10000; display: none; flex-direction: column;
            align-items: center; justify-content: center; backdrop-filter: blur(25px);
        }
        .loader {
            width: 60px; height: 60px; border: 6px solid #222;
            border-top: 6px solid var(--accent); border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 25px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- NOTIFICATION COMMAND --- */
        #cmd-popup {
            position: fixed; top: 20px; right: 20px; width: 300px; background: var(--win-bg);
            border-left: 5px solid var(--accent); padding: 15px; border-radius: 8px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5); z-index: 5000; animation: slideIn 0.5s ease;
        }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* --- DESKTOP --- */
        #desktop { width: 100%; height: calc(100vh - 60px); position: relative; padding: 30px; display: grid; grid-template-columns: repeat(auto-fill, 100px); grid-template-rows: repeat(auto-fill, 110px); gap: 20px; }
        .icon { width: 90px; text-align: center; cursor: pointer; padding: 10px; border-radius: 8px; transition: 0.2s; z-index: 5; }
        .icon:hover { background: rgba(255,255,255,0.1); backdrop-filter: blur(8px); }
        .icon-img { font-size: 40px; }
        .icon-text { font-size: 11px; margin-top: 5px; text-shadow: 1px 1px 3px #000; font-weight: 500; }

        /* --- WINDOW SYSTEM --- */
        .window { position: absolute; width: 680px; height: 500px; background: var(--win-bg); border: 1px solid var(--border); box-shadow: 0 20px 40px rgba(0,0,0,0.5); display: none; flex-direction: column; z-index: 100; border-radius: 12px; overflow: hidden; }
        .win-header { padding: 12px 18px; background: #000; display: flex; justify-content: space-between; align-items: center; cursor: grab; }
        .win-controls { display: flex; gap: 8px; }
        .ctrl-btn { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; border: none; }
        .btn-min { background: #ffbd2e; } .btn-close { background: #ff5f56; }
        .win-body { flex: 1; overflow-y: auto; background: #fff; color: #000; padding: 25px; }

        /* --- SETTINGS: TOGGLES --- */
        .sec-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 1px solid #eee; }
        .toggle { position: relative; display: inline-block; width: 44px; height: 22px; }
        .toggle input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; inset: 0; background-color: #ccc; transition: .3s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(22px); }

        /* --- COMPLETION BUTTON ANIMATION --- */
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(3, 252, 132, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(3, 252, 132, 0); }
            100% { box-shadow: 0 0 0 0 rgba(3, 252, 132, 0); }
        }
        .btn-complete {
            display: none; 
            margin-top: 20px; 
            background: var(--accent); 
            color: #000; 
            border: none; 
            padding: 15px; 
            border-radius: 10px; 
            cursor: pointer; 
            width: 100%; 
            font-weight: 900; 
            text-transform: uppercase;
            animation: pulse-green 2s infinite;
        }

        /* --- START MENU & POWER --- */
        #start-menu { position: fixed; bottom: 65px; left: 10px; width: 250px; background: var(--taskbar); border: 1px solid var(--border); border-radius: 10px; display: none; flex-direction: column; padding: 15px; z-index: 2000; backdrop-filter: blur(15px); }
        .power-opt { padding: 10px; cursor: pointer; border-radius: 5px; margin-bottom: 5px; transition: 0.2s; color: #fff; }
        .power-opt:hover { background: rgba(255,255,255,0.1); }

        /* --- TASKBAR --- */
        #taskbar { position: fixed; bottom: 0; width: 100%; height: 60px; background: var(--taskbar); border-top: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 1000; }
        #window-panel { position: absolute; left: 50%; transform: translateX(-50%); display: flex; gap: 8px; }
        .panel-item { background: rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 8px; font-size: 13px; cursor: pointer; color: #fff; border: 1px solid transparent; }
        .panel-item.active { border-color: var(--accent); background: rgba(3, 252, 132, 0.1); }

        #bsod { position: fixed; inset: 0; z-index: 10000; background: #0000aa; color: #fff; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; font-family: 'JetBrains Mono'; }
    </style>
</head>
<body onclick="closeStart(event)">

<div id="power-overlay">
    <div class="loader" id="p-loader"></div>
    <h1 id="p-text" style="font-weight: 300; letter-spacing: 3px;">SHUTTING DOWN</h1>
</div>

<div id="cmd-popup">
    <strong style="color:var(--accent)">SYSTEM COMMAND:</strong>
    <p style="font-size: 13px; margin-top: 5px;">"Turn on Security features on setting" before installing Add-ons.</p>
</div>

<div id="bsod">
    <h1 style="font-size: 80px;">:(</h1>
    <h2>SECURITY_BYPASS_CRASH</h2>
    <p>System integrity compromised due to disabled security features.</p>
    <p id="reboot-timer" style="margin-top: 30px; color: var(--cyan);">Redirecting to Malware School in 5...</p>
</div>

<div id="start-menu">
    <h4 style="color:var(--accent); margin-bottom:10px;">Power Options</h4>
    <div class="power-opt" onclick="triggerRestart()">üîÑ Restart</div>
    <div class="power-opt" onclick="triggerShutdown()">üõë Shut Down</div>
    <div class="power-opt" onclick="triggerSleep()">üåô Sleep</div>
    <hr style="border:0; border-top:1px solid #333; margin:10px 0;">
    <div class="power-opt" onclick="openWin('win-settings', '‚öôÔ∏è Settings')">‚öôÔ∏è Settings</div>
</div>

<div id="desktop">
    <div class="icon" onclick="openWin('win-settings', '‚öôÔ∏è Settings')"><div class="icon-img">‚öôÔ∏è</div><div class="icon-text">Settings</div></div>
    <div class="icon" onclick="openWin('win-browser', 'üåê Browser')"><div class="icon-img">üåê</div><div class="icon-text">G_Browser</div></div>
    <div class="icon" onclick="openWin('win-files', 'üìÅ Files')"><div class="icon-img">üìÅ</div><div class="icon-text">Files</div></div>
    <div class="icon" onclick="openWin('win-games', 'üéÆ Add-ons')"><div class="icon-img">üéÆ</div><div class="icon-text">Add-ons</div></div>
    <div id="av-icon" class="icon" style="display:none;" onclick="openWin('win-av', 'üõ°Ô∏è Malwarebytes')"><div class="icon-img">üõ°Ô∏è</div><div class="icon-text">Malwarebytes</div></div>
</div>

<div id="win-settings" class="window" style="left:50px; top:50px;">
    <div class="win-header"><span>‚öôÔ∏è SYSTEM SETTINGS</span><div class="win-controls"><div class="ctrl-btn btn-min" onclick="minWin('win-settings')"></div><div class="ctrl-btn btn-close" onclick="closeWin('win-settings')"></div></div></div>
    <div class="win-body">
        <h2 style="margin-bottom:20px;">Privacy & Security</h2>
        
        <div class="sec-item">
            <div><strong>Real-time Protection</strong><br><small>Monitor system for threats</small></div>
            <label class="toggle"><input type="checkbox" id="sec1" onchange="updateSecStatus()"><span class="slider"></span></label>
        </div>
        <div class="sec-item">
            <div><strong>Cloud-delivered Protection</strong><br><small>Faster threat response</small></div>
            <label class="toggle"><input type="checkbox" id="sec2" onchange="updateSecStatus()"><span class="slider"></span></label>
        </div>
        <div class="sec-item">
            <div><strong>Automatic Sample Submission</strong><br><small>Help improve security logic</small></div>
            <label class="toggle"><input type="checkbox" id="sec3" onchange="updateSecStatus()"><span class="slider"></span></label>
        </div>
        <div class="sec-item">
            <div><strong>Tamper Protection</strong><br><small>Block unapproved setting changes</small></div>
            <label class="toggle"><input type="checkbox" id="sec4" onchange="updateSecStatus()"><span class="slider"></span></label>
        </div>

        <div id="status-box" style="margin-top:20px; padding:15px; border-radius:10px; background:#ffebeb; color:#d93025; text-align:center; font-weight:bold;">
            STATUS: VULNERABLE
        </div>

        <button id="btn-complete" class="btn-complete" onclick="window.location.href='solutions.html'">
            ‚úÖ SECURITY VERIFIED: PROCEED TO SOLUTIONS
        </button>
    </div>
</div>

<div id="win-av" class="window" style="left:120px; top:120px;">
    <div class="win-header" style="background:#0047bb;"><span>üõ°Ô∏è MALWAREBYTES</span><div class="win-controls"><div class="ctrl-btn btn-close" onclick="closeWin('win-av')"></div></div></div>
    <div class="win-body" style="background:#f8f9fa;">
        <div id="av-idle" style="text-align:center; padding:20px;">
            <div style="font-size:50px; margin-bottom:10px;">üõ°Ô∏è</div>
            <h3 id="av-status-text">System Vulnerable</h3>
            <p style="font-size:12px; color:#666; margin-bottom:20px;">Scan recommended to enable protection.</p>
            <button onclick="startAVScan()" style="background:#0047bb; color:white; border:none; padding:12px 30px; border-radius:5px; cursor:pointer; width:100%; font-weight:bold;">RUN SCAN</button>
        </div>
        <div id="av-scanning" style="display:none; text-align:center; padding:20px;">
            <h3>Scanning...</h3>
            <div style="width:100%; background:#ddd; height:10px; border-radius:5px; margin:20px 0; overflow:hidden;"><div id="av-progress" style="width:0%; height:100%; background:#0047bb; transition:0.1s;"></div></div>
            <p id="av-file" style="font-family:'JetBrains Mono'; font-size:10px; color:#666;">Checking system files...</p>
        </div>
        <div id="av-results" style="display:none; text-align:center; padding:20px;">
            <h3 style="color:#d93025;">THREATS DETECTED</h3>
            <p style="margin:10px 0;">Security features are currently disabled.</p>
            <button onclick="fixSecurity()" style="background:#1e7e34; color:white; border:none; padding:12px 30px; border-radius:5px; cursor:pointer; width:100%; font-weight:bold;">FIX & ACTIVATE NOW</button>
        </div>
    </div>
</div>

<div id="win-browser" class="window" style="left:80px; top:80px;">
    <div class="win-header"><span>üåê G_BROWSER</span><div class="win-controls"><div class="ctrl-btn btn-close" onclick="closeWin('win-browser')"></div></div></div>
    <div style="background:#eee; padding:10px; display:flex; gap:10px;">
        <input type="text" id="bSearch" style="flex:1; padding:5px 15px; border-radius:15px; border:1px solid #ccc;" placeholder="Search for security...">
        <button onclick="doWebSearch()" style="cursor:pointer; padding:0 10px;">Search</button>
    </div>
    <div class="win-body" id="bContent">Start searching for protection.</div>
</div>

<div id="win-games" class="window" style="left:150px; top:150px;">
    <div class="win-header"><span>üéÆ ADD-ON MANAGER</span><div class="win-controls"><div class="ctrl-btn btn-close" onclick="closeWin('win-games')"></div></div></div>
    <div class="win-body">
        <div style="background:#f4f4f4; padding:20px; border-radius:10px; text-align:center;">
            <h3>Free Gem Generator</h3>
            <p style="color:red; font-size:12px;">Unknown Author</p>
            <button onclick="installAddon()" style="margin-top:15px; background:#000; color:#fff; padding:10px 20px; border:none; cursor:pointer; width:100%;">INSTALL ADD-ON</button>
        </div>
    </div>
</div>

<div id="win-files" class="window" style="left:200px; top:200px;"><div class="win-header"><span>üìÅ FILE EXPLORER</span><div class="win-controls"><div class="ctrl-btn btn-close" onclick="closeWin('win-files')"></div></div></div><div class="win-body"><h3>Local Disk (C:)</h3><p style="color:red">Space: 0.1GB left / 500GB</p></div></div>

<div id="taskbar">
    <div id="start-btn" onclick="toggleStart(event)" style="font-weight:900; color:var(--accent); cursor:pointer; background:rgba(255,255,255,0.1); padding:5px 15px; border-radius:5px;">START</div>
    <div id="window-panel"></div>
    <div id="clock">00:00</div>
</div>

<script>
    let openApps = {};
    let zIdx = 100;
    let allSecurityOn = false;

    // 1. Power & Start Logic
    function toggleStart(e) { e.stopPropagation(); const s = document.getElementById('start-menu'); s.style.display = (s.style.display === 'flex' ? 'none' : 'flex'); }
    function closeStart(e) { document.getElementById('start-menu').style.display = 'none'; }

    function triggerRestart() {
        document.getElementById('start-menu').style.display = 'none';
        const overlay = document.getElementById('power-overlay');
        const text = document.getElementById('p-text');
        overlay.style.display = 'flex';
        text.innerText = "RESTARTING SIMULATION";
        setTimeout(() => {
            Object.keys(openApps).forEach(id => closeWin(id));
            document.querySelectorAll('.sec-item input').forEach(c => c.checked = false);
            updateSecStatus();
            overlay.style.display = 'none';
        }, 2000);
    }

    function triggerShutdown() {
        document.getElementById('start-menu').style.display = 'none';
        const overlay = document.getElementById('power-overlay');
        const text = document.getElementById('p-text');
        overlay.style.display = 'flex';
        text.innerText = "SHUTTING DOWN";
        setTimeout(() => { window.location.href = 'solutions.html'; }, 3000);
    }

    function triggerSleep() {
        document.getElementById('start-menu').style.display = 'none';
        const overlay = document.getElementById('power-overlay');
        const text = document.getElementById('p-text');
        const loader = document.getElementById('p-loader');
        overlay.style.display = 'flex';
        loader.style.display = 'none';
        text.innerText = "SYSTEM ASLEEP. CLICK TO WAKE.";
        overlay.onclick = () => { overlay.style.display = 'none'; loader.style.display = 'block'; overlay.onclick = null; };
    }

    // 2. Security Logic
    function updateSecStatus() {
        const s1 = document.getElementById('sec1').checked;
        const s2 = document.getElementById('sec2').checked;
        const s3 = document.getElementById('sec3').checked;
        const s4 = document.getElementById('sec4').checked;
        const box = document.getElementById('status-box');
        const avStatus = document.getElementById('av-status-text');
        const completeBtn = document.getElementById('btn-complete');

        if(s1 && s2 && s3 && s4) {
            allSecurityOn = true;
            box.innerText = "STATUS: FULLY PROTECTED";
            box.style.background = "#e6ffed"; box.style.color = "#1e7e34";
            document.getElementById('cmd-popup').style.display = 'none';
            if(avStatus) avStatus.innerText = "System Protected";
            if(completeBtn) completeBtn.style.display = 'block'; // Show Button
        } else {
            allSecurityOn = false;
            box.innerText = "STATUS: VULNERABLE";
            box.style.background = "#ffebeb"; box.style.color = "#d93025";
            document.getElementById('cmd-popup').style.display = 'block';
            if(avStatus) avStatus.innerText = "System Vulnerable";
            if(completeBtn) completeBtn.style.display = 'none'; // Hide Button
        }
    }

    // ANTIVIRUS SCAN LOGIC
    function startAVScan() {
        document.getElementById('av-idle').style.display = 'none';
        document.getElementById('av-scanning').style.display = 'block';
        let prog = 0;
        let pBar = document.getElementById('av-progress');
        let files = ['C:/Windows/System32', 'C:/Users/Admin/Desktop', 'C:/ProgramFiles/G_Browser', 'C:/Temp/Cache'];
        let interval = setInterval(() => {
            prog += 2;
            pBar.style.width = prog + "%";
            document.getElementById('av-file').innerText = "Scanning: " + files[Math.floor(Math.random()*files.length)];
            if(prog >= 100) {
                clearInterval(interval);
                document.getElementById('av-scanning').style.display = 'none';
                if(allSecurityOn) {
                    document.getElementById('av-idle').style.display = 'block';
                    alert("No threats found. System is secure.");
                } else {
                    document.getElementById('av-results').style.display = 'block';
                }
            }
        }, 50);
    }

    function fixSecurity() {
        document.getElementById('sec1').checked = true;
        document.getElementById('sec2').checked = true;
        document.getElementById('sec3').checked = true;
        document.getElementById('sec4').checked = true;
        updateSecStatus();
        document.getElementById('av-results').style.display = 'none';
        document.getElementById('av-idle').style.display = 'block';
        alert("Protection activated! All security features are now ON.");
    }

    // 3. Browser Search
    function doWebSearch() {
        const q = document.getElementById('bSearch').value.toLowerCase();
        const keywords = ['anti', 'vru', 'malw', 'protec', 'mbytes'];
        if (keywords.some(k => q.includes(k))) {
            document.getElementById('bContent').innerHTML = `<div style="border-bottom:1px solid #eee; padding:10px;"><a href="#" onclick="dlAV()" style="color:#1a0dab; font-weight:bold;">Malwarebytes Premium Virtual Setup</a><p style="font-size:12px;">Install real-time protection against malicious add-ons.</p></div>`;
        } else {
            document.getElementById('bContent').innerHTML = `<p>Results for "${q}"... no local security matches.</p>`;
        }
    }

    function dlAV() {
        alert("Downloading security assets...");
        setTimeout(() => { document.getElementById('av-icon').style.display = 'block'; alert("Icon added to desktop."); }, 1000);
    }

    // 4. Install Logic
    function installAddon() {
        if (!allSecurityOn) {
            document.getElementById('bsod').style.display = 'flex';
            let t = 5;
            let timer = setInterval(() => {
                t--;
                document.getElementById('reboot-timer').innerText = `Redirecting in ${t}...`;
                if (t === 0) { clearInterval(timer); window.location.href = 'malwareattack.html'; }
            }, 1000);
        } else { alert("Security Alert: Malicious activity blocked in Gem Generator."); }
    }

    // Core Window Control
    function openWin(id, label) {
        const win = document.getElementById(id); win.style.display = 'flex'; win.style.zIndex = ++zIdx;
        if (!openApps[id]) openApps[id] = label; updatePanel();
    }
    function closeWin(id) { document.getElementById(id).style.display = 'none'; delete openApps[id]; updatePanel(); }
    function minWin(id) { document.getElementById(id).style.display = 'none'; updatePanel(); }

    function updatePanel() {
        const panel = document.getElementById('window-panel'); panel.innerHTML = '';
        for (let id in openApps) {
            const item = document.createElement('div');
            item.className = 'panel-item' + (document.getElementById(id).style.display === 'flex' ? ' active' : '');
            item.innerText = openApps[id];
            item.onclick = () => {
                const win = document.getElementById(id);
                if (win.style.display === 'flex') win.style.display = 'none';
                else { win.style.display = 'flex'; win.style.zIndex = ++zIdx; }
                updatePanel();
            };
            panel.appendChild(item);
        }
    }

    // Draggable
    let dragWin = null, ox, oy;
    document.querySelectorAll('.win-header').forEach(h => {
        h.onmousedown = (e) => { dragWin = h.parentElement; dragWin.style.zIndex = ++zIdx; ox = e.clientX - dragWin.offsetLeft; oy = e.clientY - dragWin.offsetTop; }
    });
    window.onmousemove = (e) => { if (dragWin) { dragWin.style.left = (e.clientX - ox) + 'px'; dragWin.style.top = (e.clientY - oy) + 'px'; } }
    window.onmouseup = () => { dragWin = null; }

    setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}); }, 1000);
</script>
</body>
</html>
