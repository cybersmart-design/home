<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Breach Simulator â€“ Long Output</title>
<style>
body {
  background:#0b0f14;
  color:#c9d1d9;
  font-family:monospace;
  padding:16px;
  margin:0;
}

#terminal {
  background:#010409;
  border:1px solid #30363d;
  padding:12px;
  height:55vh;
  max-height:420px;
  overflow-y:auto;
  border-radius:8px;
}

input {
  width:100%;
  background:#010409;
  color:#58a6ff;
  border:1px solid #30363d;
  padding:12px;
  margin-top:12px;
  caret-color:#58a6ff;
  border-radius:8px;
  font-size:16px;
}

.alert { color:#ff7b72; }
.warn { color:#f2cc60; }
.success { color:#3fb950; }
.system { color:#8b949e; }

/* Modal */
.modal-bg {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex; justify-content:center; align-items:center;
  z-index: 999;
}
.modal {
  background:#0b0f14;
  border: 1px solid #30363d;
  padding: 20px;
  width: 92%;
  max-width: 480px;
  font-family: monospace;
  color: #c9d1d9;
  border-radius:10px;
}
.btn {
  margin-top: 10px;
  padding: 12px 14px;
  background:#58a6ff;
  border:none;
  color:#0b0f14;
  font-weight:bold;
  cursor:pointer;
  width:100%;
  border-radius:8px;
}
.btn:hover { background:#2f6fa6; }

.btn-success { background:#22c55e; }
.btn-fail { background:#ef4444; }

h2 {
  margin:0 0 12px 0;
  font-size:18px;
}

/* Back to Difficulty button */
#backDifficulty {
  position: fixed;
  top: 16px;
  right: 16px;
  padding: 8px 12px;
  background:#58a6ff;
  color:#0b0f14;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
  display:none;
}
#backDifficulty:hover { background:#2f6fa6; }
</style>
</head>

<body>

<h2>ðŸ›¡ Data Breach Investigation Console</h2>

<!-- BACK TO DIFFICULTY -->
<button id="backDifficulty" onclick="showDifficulty()">Back to Difficulty</button>

<!-- INTRO / MODE SELECTION -->
<div class="modal-bg" id="introModal">
  <div class="modal">
    <h3>âš  Simulation Notice</h3>
    <p>This is <strong>NOT a real security system</strong>. It is a <strong>simulation for training</strong> and awareness only.</p>
    <p>Choose a mode below:</p>

    <button class="btn" onclick="selectMode('guided')">Guided Mode</button>
    <button class="btn" onclick="selectMode('challenge')">Challenge Mode</button>

    <p style="margin-top: 12px; color:#8b949e;">
      Guided mode = easier + hints.<br>
      Challenge mode = harder + no hints.
    </p>
  </div>
</div>

<div id="terminal"></div>
<input id="cmd" placeholder="command@security-console$">

<!-- SUCCESS / FAIL POPUP -->
<div class="modal-bg" id="resultModal" style="display:none;">
  <div class="modal">
    <h3 id="resultTitle"></h3>
    <p id="resultText"></p>
    <button class="btn btn-success" id="tryAgainBtn">Try Again</button>
    <button class="btn btn-fail" onclick="exitSimulation()">Exit</button>
  </div>
</div>

<script>
const term = document.getElementById("terminal");
const cmd = document.getElementById("cmd");
const backBtn = document.getElementById("backDifficulty");
let busy = false;
let score = 0;
let mode = null;
let completed = false;

function log(msg, cls="system") {
  const d = document.createElement("div");
  d.className = cls;
  d.textContent = msg;
  term.appendChild(d);
  term.scrollTop = term.scrollHeight;
}

function stream(lines, done, speed=120) {
  busy = true;
  cmd.disabled = true;
  let i = 0;
  const t = setInterval(() => {
    if (i >= lines.length) {
      clearInterval(t);
      busy = false;
      cmd.disabled = false;
      cmd.focus();
      if (done) done();
      return;
    }
    log(lines[i]);
    i++;
  }, speed);
}

function selectMode(m) {
  mode = m;
  document.getElementById("introModal").style.display = "none";
  backBtn.style.display = "inline-block";
  startConsole();
}

function startConsole() {
  term.innerHTML = "";
  score = 0;
  completed = false;
  log("security-console@corpnet:~$ monitoring enabled");
  log("Mode: " + mode.toUpperCase());
  log("Type 'help' for commands.");
  cmd.focus();
}

function showResult(success, text) {
  document.getElementById("resultTitle").textContent = success ? "âœ” Simulation Complete" : "âœ– Simulation Failed";
  document.getElementById("resultText").textContent = text;
  document.getElementById("resultModal").style.display = "flex";
  cmd.disabled = true;
}

function hideResult() {
  document.getElementById("resultModal").style.display = "none";
  cmd.disabled = false;
  cmd.focus();
}

document.getElementById("tryAgainBtn").onclick = () => {
  hideResult();
  startConsole();
};

function exitSimulation() {
  document.body.innerHTML = "<h2 style='padding:40px;text-align:center'>Simulation ended. You may close this window.</h2>";
}

// Show difficulty selection again
function showDifficulty() {
  document.getElementById("introModal").style.display = "flex";
  backBtn.style.display = "none";
  mode = null;
  term.innerHTML = "";
  cmd.value = "";
  cmd.disabled = false;
  completed = false;
  score = 0;
}

cmd.addEventListener("keydown", e => {
  if (e.key !== "Enter") return;
  const input = cmd.value.trim();
  const c = input.toLowerCase();
  cmd.value = "";

  if (!mode) {
    log("Select a mode first.", "alert");
    return;
  }

  if (busy) {
    log("system busy... please wait", "warn");
    return;
  }

  log("> " + input);

  if (completed) {
    log("Simulation already completed. Try again or exit.", "warn");
    return;
  }

  if (c === "help") {
    log("Available commands:");
    log(" - audit access logs");
    log(" - check database queries");
    log(" - inspect outbound connections");
    log(" - scan endpoints");
    log(" - containment");
    log(" - clear");
    log(" - score");
    return;
  }

  if (c === "clear") {
    term.innerHTML = "";
    startConsole();
    return;
  }

  if (c === "score") {
    log("Current score: " + score, "success");
    return;
  }

  if (c === "audit access logs") {
    stream([
      "Reading access_log_2026_02_06.log...",
      "Reading access_log_2026_02_05.log...",
      "Reading access_log_2026_02_04.log...",
      "Preparing access audit engine...",
      "Loading user activity index...",
      "Loading geo-IP database...",
      "Checking login frequency thresholds...",
      "Analyzing read/write ratios...",
      "Scanning for abnormal query bursts...",
      "Scanning for off-hours access...",
      "Comparing baseline behavior...",
      "User: jdoe | baseline exceeded (x12)",
      "User: svc-backup | normal behavior",
      "User: admin | abnormal read volume detected",
      "Extracting session metadata...",
      "Resolving IP addresses...",
      "IP 185.22.xxx.xxx â†’ RU",
      "Cross-checking MFA enforcement...",
      "MFA disabled on admin account",
      "Validating IAM policies...",
      "Policy mismatch detected",
      "Rebuilding access timeline...",
      "Generating audit summary..."
    ], () => {
      log("SUCCESS: Unauthorized access identified", "success");
      score += mode === "guided" ? 10 : 20;
    }, 90);
    return;
  }

  // Other commands (check database, inspect outbound, scan endpoints, containment)
  // ... leave the rest of your command logic as-is
  log("command not found", "alert");
});
</script>

</body>
</html>
