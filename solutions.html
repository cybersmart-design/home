<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CyberSmart | SIM_CORE_FIXED_TOP</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@900&display=swap" rel="stylesheet" />
    <style>
        :root {
            --bg: #010409;
            --accent: #03fc84;
            --cyan: #09eef5;
            --red: #ff3e3e;
            --panel: rgba(2, 8, 18, 0.95);
            --border: rgba(9, 238, 245, 0.2);
            --header-height: 110px; /* Fixed height for mobile menu */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: var(--bg); 
            color: #fff; 
            font-family: 'JetBrains Mono', monospace; 
            overflow-x: hidden;
        }

        #bgCanvas { position: fixed; top: 0; left: 0; z-index: -1; pointer-events: none; }

        /* --- FIXED TOP NAVIGATION (MOBILE) --- */
        .protocol-sidebar {
            background: var(--panel);
            border-bottom: 1px solid var(--border);
            padding: 15px;
            display: flex;
            flex-direction: row;
            overflow-x: auto;
            gap: 10px;
            position: fixed; /* Always stays at the top */
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            z-index: 1000;
            scrollbar-width: none;
            backdrop-filter: blur(15px);
        }
        .protocol-sidebar::-webkit-scrollbar { display: none; }

        .protocol-tab {
            flex: 0 0 140px;
            padding: 10px;
            border: 1px solid var(--border);
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .protocol-tab h4 { font-size: 11px; }
        .protocol-tab.active {
            background: rgba(9, 238, 245, 0.1);
            border-color: var(--cyan);
            box-shadow: 0 0 15px rgba(9, 238, 245, 0.2);
        }

        /* --- MAIN VIEWPORT (PUSHED DOWN) --- */
        .simulator-grid {
            padding-top: var(--header-height); /* Prevents menu from covering content */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .core-viewport {
            background: var(--panel);
            border: 1px solid var(--border);
            margin: 10px;
            padding: 25px 15px;
            background-image: linear-gradient(var(--border) 1px, transparent 1px), linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 30px 30px;
            flex-grow: 1;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 8px;
            color: var(--cyan);
        }

        .content-display h2 { 
            font-family: 'Outfit', sans-serif; 
            font-size: clamp(1.8rem, 8vw, 3.5rem); 
            margin-bottom: 15px; 
            text-transform: uppercase;
        }

        .solution-box {
            background: rgba(255, 255, 255, 0.03);
            padding: 12px;
            border-left: 3px solid var(--accent);
            margin-bottom: 10px;
        }

        .live-terminal {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--border);
            height: 200px;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
        }

        #feed-container {
            padding: 10px;
            overflow: hidden;
            font-size: 9px;
        }

        .btn-launch {
            display: block;
            padding: 20px;
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
            text-align: center;
            text-decoration: none;
            font-weight: bold;
            margin-top: 30px;
            text-transform: uppercase;
        }

        /* --- DESKTOP VIEWPORT (SIDEBAR RESTORED) --- */
        @media (min-width: 992px) {
            :root { --header-height: 0px; }
            
            .simulator-grid {
                display: grid;
                grid-template-columns: 300px 1fr;
                padding-top: 0;
                padding: 20px;
                gap: 20px;
            }

            .protocol-sidebar {
                position: sticky;
                top: 20px;
                width: auto;
                height: fit-content;
                flex-direction: column;
                overflow-x: visible;
                border: 1px solid var(--border);
            }

            .protocol-tab { flex: none; width: 100%; padding: 15px; }
            .protocol-tab h4 { font-size: 14px; }
            
            .main-content-split { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 30px; }
            .live-terminal { height: 400px; margin-top: 0; }
        }
    </style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<div class="simulator-grid">
    <aside class="protocol-sidebar">
        <div class="protocol-tab active" onclick="loadCore(0)">
            <small>01</small>
            <h4 class="scramble">DATA_BREACH</h4>
        </div>
        <div class="protocol-tab" onclick="loadCore(1)">
            <small>02</small>
            <h4 class="scramble">PHISHING_LINK</h4>
        </div>
        <div class="protocol-tab" onclick="loadCore(2)">
            <small>03</small>
            <h4 class="scramble">MALWARE_X</h4>
        </div>
    </aside>

    <main class="core-viewport">
        <div class="status-header">
            <span>CORE_STATUS: <span id="status-text" style="color: var(--accent);">ACTIVE</span></span>
            <span>2026.02.15</span>
        </div>

        <div class="main-content-split">
            <div id="core-content" class="content-display"></div>
            
            <div class="live-terminal">
                <div style="background:var(--border); padding:5px 10px; font-size:9px; color:var(--cyan);">LIVE_CORE_FEED</div>
                <div id="feed-container"></div>
            </div>
        </div>

        <a href="#" id="launch-btn" class="btn-launch">Initialize Simulation</a>
    </main>
</div>

<script>
    const protocolData = [
        {
            title: "Data Breach",
            desc: "Unauthorized exfiltration of sensitive organizational assets.",
            solutions: [
                ["MFA_ENFORCE", "Enable 2-factor authentication."],
                ["ENCRYPTION", "Resting data AES-256."]
            ],
            feed: ["> Sniffing port 80...", "!! ALERT: DB EXFIL"],
            link: "databreach.html",
            color: "#09eef5"
        },
        {
            title: "Phishing",
            desc: "Deceptive social engineering campaigns.",
            solutions: [
                ["DOMAIN_CHECK", "Verify SPF records."],
                ["URL_SCAN", "Sandbox detonation."]
            ],
            feed: ["> Scanning SMTP...", "!! ALERT: SPOOFED"],
            link: "phishing.html",
            color: "#03fc84"
        },
        {
            title: "Malware",
            desc: "Malicious code designed for persistence.",
            solutions: [
                ["SEGMENTATION", "VLAN isolation."],
                ["EDR_DEPLOY", "Kill processes."]
            ],
            feed: ["> Registry scan...", "!! ALERT: TROJAN"],
            link: "malwareattack.html",
            color: "#ff3e3e"
        }
    ];

    function scrambleText(element, finalMessage) {
        if (!element) return;
        const chars = "!<>-_\\/[]{}â€”=+*^?#________";
        let iteration = 0;
        const interval = setInterval(() => {
            element.innerText = finalMessage.split("").map((char, index) => {
                if(index < iteration) return finalMessage[index];
                return chars[Math.floor(Math.random() * chars.length)];
            }).join("");
            if(iteration >= finalMessage.length) clearInterval(interval);
            iteration += 1 / 3;
        }, 30);
    }

    let feedInterval;
    function startFeed(messages, color) {
        const container = document.getElementById('feed-container');
        container.innerHTML = "";
        clearInterval(feedInterval);
        feedInterval = setInterval(() => {
            const msg = messages[Math.floor(Math.random() * messages.length)];
            const line = document.createElement('div');
            line.style.color = msg.includes('!!') ? '#ff3e3e' : color;
            line.innerHTML = `> [${new Date().toLocaleTimeString()}] ${msg}`;
            container.prepend(line);
            if (container.childNodes.length > 8) container.removeChild(container.lastChild);
        }, 1500);
    }

    function loadCore(index) {
        const data = protocolData[index];
        const display = document.getElementById('core-content');
        const launchBtn = document.getElementById('launch-btn');

        document.querySelectorAll('.protocol-tab').forEach((t, i) => t.classList.toggle('active', i === index));

        display.innerHTML = `
            <h2 id="main-title" style="color: ${data.color}">${data.title}</h2>
            <p id="main-desc" style="color: #a3b8cc; font-size: 13px; margin-bottom: 20px;"></p>
            <div class="solution-grid">
                ${data.solutions.map((s, i) => `
                    <div class="solution-box" style="border-left-color: ${data.color}">
                        <strong id="sol-title-${i}" style="color: ${data.color}"></strong>
                        <p id="sol-desc-${i}" style="font-size: 11px; margin-top:5px; color: #a3b8cc;"></p>
                    </div>
                `).join('')}
            </div>
        `;

        scrambleText(document.getElementById('main-title'), data.title);
        scrambleText(document.getElementById('main-desc'), data.desc);
        data.solutions.forEach((s, i) => {
            scrambleText(document.getElementById(`sol-title-${i}`), s[0]);
            scrambleText(document.getElementById(`sol-desc-${i}`), s[1]);
        });

        launchBtn.href = data.link;
        launchBtn.style.borderColor = data.color;
        launchBtn.style.color = data.color;
        startFeed(data.feed, data.color);
    }

    loadCore(0);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bgCanvas'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    const geo = new THREE.BufferGeometry();
    const pos = [];
    for(let i=0; i<1000; i++) pos.push(THREE.MathUtils.randFloatSpread(100), THREE.MathUtils.randFloatSpread(100), THREE.MathUtils.randFloatSpread(100));
    geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
    const mat = new THREE.PointsMaterial({ color: 0x09eef5, size: 0.1, transparent: true, opacity: 0.2 });
    const points = new THREE.Points(geo, mat);
    scene.add(points);
    camera.position.z = 50;
    function animate() { requestAnimationFrame(animate); points.rotation.y += 0.0008; renderer.render(scene, camera); }
    animate();

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
</body>
</html>
